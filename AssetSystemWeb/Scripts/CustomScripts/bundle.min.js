$(document).ready(function(){function i(n){$("#IncludedRoles").append('<option value="'+n+'">'+n+"<\/option>")}function r(n){$("#SystemRoles").append('<option value="'+n+'">'+n+"<\/option>")}function u(n){$("#AssignedCompanies").append('<option value="'+n.val()+'">'+n.text()+"<\/option>")}function f(n){$("#Companies").append('<option value="'+n.val()+'">'+n.text()+"<\/option>")}function n(n){$.ajax({url:t+"/Account/CheckUsername",method:"POST",dataType:"JSON",data:{username:n},beforeSend:function(){},success:function(n){return n.IsExist?($("#ValidationErrorUsername").text("Username already used").removeClass("text-success").addClass("text-danger"),!1):($("#ValidationErrorUsername").text("Username is valid").removeClass("text-danger").addClass("text-success"),!0)},error:function(){}})}var t=$("#SystemRootUrl").val();$("#btnAddCompany").on("click",function(){$("#Companies option:selected").each(function(){u($(this));$(this).remove()})});$("#btnRemoveCompany").on("click",function(){$("#AssignedCompanies option:selected").each(function(){f($(this));$(this).remove()})});$("#newAccessbtnSubmit").click(function(){var i=$("#UserName").val(),t;n(i);$("#RegisterSystemAccess").valid()&&(t=$("#ValidationErrorUsername").hasClass("text-success"),t?(alert("NotExist"),$("select > option").prop("selected",!0),$("#RegisterSystemAccess").submit()):alert("Exist"))});$("#UpdateAccessbtnSubmit").click(function(){var t=$("#UserName").val(),i=$("#oldUsername").val(),r,u;alert("old"+i+"New"+t);t!==i?n(t):$("#ValidationErrorUsername").val("Username Not Changed").addClass("text-success");r=$("#Password").val();r===""?($("#IsChangePassword").val("false"),$("#Password").val("Undefined"),$("#ConfirmPassword").val("Undefined")):$("#IsChangePassword").val("true");$("#RegisterSystemAccess").valid()&&(u=$("#ValidationErrorUsername").hasClass("text-success"),u?(alert("NotExist"),$("select > option").prop("selected",!0),$("#RegisterSystemAccess").submit()):alert("Exist"))});$("#oldUsername").val($("#UserName").val());$("#UserName").focusout(function(){var t=$(this).val(),i=$("#oldUsername").val();i!==""?t!==i?n(t):$("#ValidationErrorUsername").text("Username not changed").removeClass("text-danger").addClass("text-success"):t!==""&&n(t)});$("#AddRoles").on("click",function(){$("#SystemRoles option:selected").each(function(){i($(this).text());$(this).remove()})});$("#RemoveRole").on("click",function(){$("#IncludedRoles option:selected").each(function(){r($(this).text());$(this).remove()})})});$(document).ready(function(){function t(t,i){$.ajax({url:n+"/Asset/CheckDetailsIsExist",data:{type:t,Details:i.val()},type:"POST",dataType:"json",success:function(n){if(n!==null){var t=i.closest(".errorBorder"),r=i.next(".errorIcon");n?(t.removeClass("has-error"),r.removeClass("glyphicon-remove"),t.addClass("has-warning"),r.addClass("glyphicon-warning-sign")):(t.removeClass("has-error"),r.removeClass("glyphicon-remove"),t.removeClass("has-warning"),r.removeClass("glyphicon-warning-sign"))}}})}function i(t){$.ajax({url:n+"/Asset/GetAssetItemFullDetail",data:{Id:t.val()},type:"POST",dataType:"json",success:function(n){var r=t.closest(".errorBorder"),u=t.next(".errorIcon"),i;n.ItemId!==0?(i=$(t).closest("tr"),r.removeClass("has-error"),u.removeClass("glyphicon-remove"),r.removeClass("has-warning"),u.removeClass("glyphicon-warning-sign"),i.find(".ItemDescription").text(n.ItemDescription),i.find(".ItemSerialDetail").text(n.SerialNumber),i.find(".ItemKeyDetail").text(n.ItemKeyDetail),i.find(".ItemPrice").text(n.Price),i.find(".ItemRemarks").text(n.ItemRemarks),i.find(".ItemDescription").val(n.ItemDescription),i.find(".ItemSerialDetail").val(n.SerialNumber),i.find(".ItemKeyDetail").val(n.ItemKeyDetail),i.find(".ItemRemarks").val(n.ItemRemarks),i.find(".ItemPrice").val(n.Price),i.find(".AssetItemId").val(n.ItemId),console.log(n)):(i=$(t).closest("tr"),r.removeClass("has-error"),u.removeClass("glyphicon-remove"),r.addClass("has-warning"),u.addClass("glyphicon-warning-sign"),i.find(".ItemDescription").text(""),i.find(".ItemSerialDetail").text(""),i.find(".ItemKeyDetail").text(""),i.find(".ItemRemarks").text(""),i.find(".ItemPrice").text(""),i.find(".ItemDescription").val(""),i.find(".ItemSerialDetail").val(""),i.find(".ItemKeyDetail").val(""),i.find(".ItemRemarks").val(""),i.find(".ItemPrice").val(""),i.find(".AssetItemId").val(0),console.log(n))}})}function r(t){$(t).autocomplete({source:function(i,r){$.ajax({url:n+"/Asset/GetAutoCompleteLookUp",data:{groupOf:"AssetItemDetail",keyword:$(t).val(),Description:$(t).closest("td").prev().find(".ItemTypeSelect").val()},type:"POST",dataType:"json",success:function(n){r($.map(n,function(n){return{label:n.Name,value:n.Name}}))}})},messages:{noResults:"",results:function(){}}})}$(".btnDelete").click(function(n){n.preventDefault();n.stopImmediatePropagation();var t=$(this).closest("tr");t.remove()});var n=$("#SystemRootUrl").val();$(".ItemSerialDetail").focusout(function(n){n.stopImmediatePropagation();var i=t("SerialNumber",$(this))});$(".ItemKeyDetail").focusout(function(n){n.stopImmediatePropagation();var i=t("ItemKeyDetail",$(this))});$(".ItemTypeId").focusout(function(n){n.stopImmediatePropagation();var t=i($(this))});$(".ItemTypeSelect").selectmenu();$(".ItemDetailDescription").each(function(){r($(this))})});$(document).ready(function(){function i(){$(".AssetItemId").each(function(){r($(this))})}function r(t){t.val()!==0&&$.ajax({url:n+"/Asset/CheckDetailIsAvailable",data:{Details:t.val()},type:"POST",dataType:"json",success:function(n){if(n!==null){var f=t.closest("tr"),u=f.find(".ItemTypeId"),r=u.closest(".errorBorder"),i=u.next(".errorIcon");n?(r.removeClass("has-warning"),i.removeClass("glyphicon-warning-sign"),r.removeClass("has-error"),i.removeClass("glyphicon-remove"),i.css("visibility","hidden")):(r.removeClass("has-warning"),i.removeClass("glyphicon-warning-sign"),r.addClass("has-error"),i.addClass("glyphicon-remove"),i.css("visibility","visible"))}else return alert("NULL")}})}function u(){$(".ItemSerialDetail").each(function(){t("SerialNumber",$(this))});$(".ItemKeyDetail").each(function(){t("ItemKeyDetail",$(this))})}function t(t,i){$.ajax({url:n+"/Asset/CheckDetailsIsExist",data:{type:t,Details:i.val()},type:"POST",dataType:"json",success:function(n){if(n!==null){var r=i.closest(".errorBorder"),t=i.next(".errorIcon");return n?(r.removeClass("has-warning"),t.removeClass("glyphicon-warning-sign"),r.addClass("has-error"),t.addClass("glyphicon-remove"),t.css("visibility","visible")):(r.removeClass("has-warning"),t.removeClass("glyphicon-warning-sign"),r.removeClass("has-error"),t.removeClass("glyphicon-remove"),t.css("visibility","hidden")),n}}})}$(".ItemStatusSelect").selectmenu();var n=$("#SystemRootUrl").val(),f=$("#AssetTable").DataTable({responsive:!0,initComplete:function(){var n=this.api();n.$("tr").hover(function(){$(this).css("cursor","pointer")},function(){$(this).css("cursor","auto")})},autoWidth:!1}),e=$("#assetItemTable").DataTable({responsive:!0,initComplete:function(){var n=this.api();n.$("tr").hover(function(){$(this).css("cursor","pointer")},function(){$(this).css("cursor","auto")})},autoWidth:!1});$("#btnUpgradeAsset").click(function(){var r=' <div id="assetTableError" class="alert alert-danger" role="alert">  <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"><\/span>  <span class="sr-only">Error:<\/span>  Please check item details  <\/div> ',t;$("#upgradeAssetFrm").valid()?(i(),t=$("#upgradeAssetFrm").serialize(),$.ajax({type:"POST",datatype:"JSON",url:n+"/Asset/CheckAssetIsAvailableForUpgrade",data:t,success:function(n){n?$("#upgradeAssetFrm").submit():(console.log(n),$(r).insertBefore("#upgradeParts"),setTimeout(function(){$("#assetTableError").remove()},5e3))}})):$("#AssetSaveModal").modal("show")});$("#btnCreateNewAsset").click(function(){var i=' <div id="assetTableError" class="alert alert-danger" role="alert">  <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"><\/span>  <span class="sr-only">Error:<\/span>  Please item details  <\/div> ',t;$("#addNewAssetFrm").valid()?(u(),t=$("#addNewAssetFrm").serialize(),console.log(t),$.ajax({type:"POST",datatype:"JSON",url:n+"/Asset/CheckAssetIsExisting",data:t,success:function(n){n?$("#addNewAssetFrm").submit():($(i).insertBefore("#assetDetails"),setTimeout(function(){$("#assetTableError").remove()},5e3))}})):$("#AssetSaveModal").modal("show")});$("#UpdateAssetStatus").click(function(){$.ajax({url:n+"/Asset/UpdateAssetStatus",Type:"POST",datatype:"html",data:{Id:$(this).prop("value")},success:function(n){$("#UpdateAssetModal > .modal-dialog > .modal-content > .modal-body").html("");$("#UpdateAssetModal > .modal-dialog > .modal-content > .modal-body").append(n)}})});$("#updateStatusBtn").click(function(){$("#updateStatusForm").submit()});$("#addNewAssetDetails").click(function(){$.ajax({url:n+"/Asset/AddNewAssetDetails",type:"GET",dataType:"html",success:function(n){$("#assetDetails").append(n);$("#addNewAssetFrm").removeData("validator");$("#addNewAssetFrm").removeData("unobtrusiveValidation");$.validator.unobtrusive.parse("#addNewAssetFrm")},error:function(){}})});$("#addNewAssetItemDetails").click(function(){$.ajax({url:n+"/AssetItem/NewAssetItem",type:"GET",dataType:"html",success:function(n){$("#assetDetails").append(n);$("#addNewAssetFrm").removeData("validator");$("#addNewAssetFrm").removeData("unobtrusiveValidation");$.validator.unobtrusive.parse("#addNewAssetFrm")},error:function(){}})});$(".CompanySelection").selectmenu();$("#AssetDescriptionLookUp").autocomplete({source:function(t,i){$.ajax({url:n+"/Asset/GetAutoCompleteLookUp",data:{groupOf:"AssetItemDesc",keyword:$("#AssetDescriptionLookUp").val()},type:"POST",dataType:"json",success:function(n){i($.map(n,function(n){return{label:n.Name,value:n.Name}}))}})},messages:{noResults:"",results:function(){}}});$("#VendorDescriptionLookUp").autocomplete({source:function(t,i){$.ajax({url:n+"/Asset/GetAutoCompleteLookUp",data:{groupOf:"Vendor",keyword:$("#VendorDescriptionLookUp").val()},type:"POST",dataType:"json",success:function(n){i($.map(n,function(n){return{label:n.Name,value:n.Name}}))}})},messages:{noResults:"",results:function(){}}});$("#VendorDescriptionLookUp").bind("paste",function(n){n.preventDefault()});$("#addBufferUpgradeAssetDetails").click(function(){$.ajax({url:n+"/Asset/AddNewAssetUpgradeDetail",type:"GET",dataType:"html",success:function(n){$("#upgradeParts").append(n);$("#upgradeAsset").removeData("validator");$("#upgradeAsset").removeData("unobtrusiveValidation");$.validator.unobtrusive.parse("#upgradeAsset")},error:function(){}})});$("#SupplierNameLookUp").autocomplete({source:function(t,i){$.ajax({url:n+"/Asset/GetFullSupplierDetailsList",data:{SupplierName:$("#SupplierNameLookUp").val()},type:"POST",dataType:"json",success:function(n){i($.map(n,function(n){return{label:n.Name,value:n.Name}}))}})},messages:{noResults:"",results:function(){}}});$("#SupplierNameLookUp").focusout(function(){$.ajax({url:n+"/Asset/GetFullSupplierDetails",data:{SupplierName:$("#SupplierNameLookUp").val()},type:"POST",dataType:"json",success:function(n){n!==null&&($("#InvoiceDetails_SupplierDetails_Address").val(n.Address),$("#InvoiceDetails_SupplierDetails_ContactNumber").val(n.ContactNumber),$("#InvoiceDetails_SupplierDetails_EmailAdd").val(n.EmailAdd),$("#InvoiceDetails_SupplierDetails_Id").val(n.Id),$("#InvoiceDetails_SupplierDetails_Address").attr("readonly","readonly"),$("#InvoiceDetails_SupplierDetails_ContactNumber").attr("readonly","readonly"),$("#InvoiceDetails_SupplierDetails_EmailAdd").attr("readonly","readonly"),n.Id===null&&$("#InvoiceDetails_SupplierDetails_Id").val(""),n.Address===null&&$("#InvoiceDetails_SupplierDetails_Address").removeAttr("readonly"),n.ContactNumber===null&&$("#InvoiceDetails_SupplierDetails_ContactNumber").removeAttr("readonly"),n.EmailAdd===null&&$("#InvoiceDetails_SupplierDetails_EmailAdd").removeAttr("readonly"))}})})});$(".DeleteAsset").click(function(n){console.log("test click");n.preventDefault();var t=$(this).closest("tr");t.remove()});$(document).ready(function(){function t(t){var i=t;i!==""&&$.ajax({url:n+"/Consignment/GetUserInformation",method:"POST",data:{IdNum:$("#CompanyId").val()},dataType:"JSON",success:function(n){$(".UserFirstname").text(n.Firstname);$(".UserMiddlename").text(n.Middlename);$(".UserSurname").text(n.Surname);$("#ConsigneeCompanyId").val(n.CompanyId);$("#UserId").val(n.Id);$("#assetDetails > tbody > tr").remove()},error:function(){$(".UserFirstname").text("");$(".UserMiddlename").text("");$(".UserSurname").text("");$("#UserId").val("");$("#ConsigneeCompanyId").val("");$("#AssetNumber").val("");$("#AssetDescription").text("");$("#assetDetails > tbody > tr").remove();$("#UserDetail").fadeIn().fadeOut(500)}});$("#UserId").val()===""&&($("#AssetNumber").val(""),$("#AssetDescription").text(""),$("#assetDetails > tbody > tr").remove())}function r(t){$.ajax({url:n+"/Consignment/AddNewAssets",method:"POST",dataType:"html",data:{assetNumber:t},success:function(n){$("#assetDetails > tbody").append(n);$("#AssetNumber").val("");$("#AssetDescription").text("")},error:function(){console.log("opening child ajax success error");console.log("AJAX ERROR")}})}function u(n){var t=0;return $(".AssetNumberDetails").each(function(){var i=$(this).val();i.toUpperCase()===n.toUpperCase()&&(t=t+1)}),t>0?!0:!1}var f=$("#consignmentTable").DataTable({responsive:!0,initComplete:function(){var n=this.api();n.$("tr").on("dblclick",function(){var n=$(this).attr("id");formChild(n)});n.$("tr").hover(function(){$(this).css("cursor","pointer")},function(){$(this).css("cursor","auto")})},autoWidth:!1}),i,n;$("#showLookup").click(function(){$("#UserLookUp").modal("show")});i=$("#userLookupTbl").DataTable({responsive:!0,initComplete:function(){var n=this.api();n.$("tr").on("dblclick",function(){var n=$(this).attr("id");$("#CompanyId").val(n);t(n);$("#UserLookUp").modal("hide")});n.$("tr").hover(function(){$(this).css("cursor","pointer")},function(){$(this).css("cursor","auto")})},autoWidth:!1});$("#AssetError").hide();$("#UserDetail").hide();n=$("#SystemRootUrl").val();$("#AssetNumber").focusout(function(){var t=$(this).val(),i=$("#UserId").val();i===""?($("#UserDetail").fadeIn().fadeOut(500),$("#AssetNumber").val(""),$("#AssetDescription").text(""),$("#assetDetails > tbody > tr").remove()):t!==""&&$.ajax({url:n+"/Consignment/GetAssetInformation",method:"POST",data:{assetNumber:$("#AssetNumber").val(),userId:$("#UserId").val()},dataType:"JSON",success:function(n){$("#AssetDescription").text(n)},error:function(){$("#AssetError").fadeIn().fadeOut(500)}})});$("#submitConsigment").click(function(){var n=$("#assetDetails tr").length;$("#UserId").val()!==""&&n>1?$("#consignmentForm").submit():alert("please verify inputs")});$("#CompanyId").focusout(function(){t($(this).val())});$("#AddConsignmentAsset").click(function(){var n=$("#AssetNumber").val();u(n)||r(n)})});$(document).ready(function(){$(".ItemStatusSelect").selectmenu()});$(document).ready(function(){function r(t){$.ajax({url:n+"/Account/UpdateUserAccess",dataType:"html",type:"GET",data:{UserId:t},success:function(n){$("#modalAccess").modal("show");$("#modalAccess > .modal-dialog > .modal-content > .modal-body").html("");$("#modalAccess > .modal-dialog > .modal-content > .modal-body").append(n);$("#modalAccess > .modal-dialog > .modal-content > .modal-header > .modal-title").html("Update User");$("#modalAccess > .modal-dialog > .modal-content > .modal-footer").html("");$("#modalAccess > .modal-dialog > .modal-content > .modal-footer").append(f);$("#RegisterSystemAccess").removeData("validator");$("#RegisterSystemAccess").removeData("unobtrusiveValidation");$.validator.unobtrusive.parse("#RegisterSystemAccess")},error:function(){alert("error calling ajax")}})}function e(t){$.ajax({url:n+"/SystemUser/ForUpdateData",type:"GET",dataType:"html",data:{Id:t},success:function(n){$("#userModel").modal("show");$("#userModel > .modal-dialog > .modal-content > .modal-body").html("");$("#userModel > .modal-dialog > .modal-content > .modal-body").append(n);$("#userModel > .modal-dialog > .modal-content > .modal-header > .modal-title").html("Update User");$("#userModel > .modal-dialog > .modal-content > .modal-footer").html("");$("#userModel > .modal-dialog > .modal-content > .modal-footer").append(i);$("#UpdateDetailFrm").removeData("validator");$("#UpdateDetailFrm").removeData("unobtrusiveValidation");$.validator.unobtrusive.parse("#UpdateDetailFrm")},error:function(){console.log("opening child ajax success error");console.log("AJAX ERROR")}})}function o(t){$.ajax({url:n+"/Account/CheckEmailAddress",method:"POST",dataType:"JSON",data:{Email:t},beforeSend:function(){},success:function(n){n.ValidationError!==""?$("#ValidationErrorEmail").text(n.ValidationError).removeClass("text-success").addClass("text-danger"):$("#ValidationErrorEmail").text("Email is valid").removeClass("text-danger").addClass("text-success")},error:function(){}})}var n=$("#SystemRootUrl").val(),s=$("#UserTable").DataTable({responsive:!0,initComplete:function(){var n=this.api();n.$("tr").on("dblclick",function(){var n=$(this).attr("id");e(n)});n.$("tr").hover(function(){$(this).css("cursor","pointer")},function(){$(this).css("cursor","auto")})},autoWidth:!1}),h=$("#userConsignments").DataTable({responsive:!0,initComplete:function(){var n=this.api();n.$("tr").hover(function(){$(this).css("cursor","pointer")},function(){$(this).css("cursor","auto")})},autoWidth:!1}),c=$("#UserAccessTable").DataTable({responsive:!0,initComplete:function(){var n=this.api();n.$("tr").on("dblclick",function(){var n=$(this).attr("Id");r(n)});n.$("tr").hover(function(){$(this).css("cursor","pointer")},function(){$(this).css("cursor","auto")})},autoWidth:!1}),u='<button type="button" class="btn btn-success" id="newAccessbtnSubmit">Register<\/button>',f='<button type="button" class="btn btn-success" id="UpdateAccessbtnSubmit">Update<\/button>',t,i;$("#CreateNewAccess").click(function(){$.ajax({url:n+"/Account/RegisterUser",dataType:"html",type:"GET",success:function(n){$("#modalAccess").modal("show");$("#modalAccess > .modal-dialog > .modal-content > .modal-body").html("");$("#modalAccess > .modal-dialog > .modal-content > .modal-body").append(n);$("#modalAccess > .modal-dialog > .modal-content > .modal-header > .modal-title").html("Create User");$("#modalAccess > .modal-dialog > .modal-content > .modal-footer").html("");$("#modalAccess > .modal-dialog > .modal-content > .modal-footer").append(u);$("#RegisterSystemAccess").removeData("validator");$("#RegisterSystemAccess").removeData("unobtrusiveValidation");$.validator.unobtrusive.parse("#RegisterSystemAccess")},error:function(){alert("error calling ajax")}})});t='<button type="button" class="btn btn-default" data-dismiss="modal">Close<\/button><button type="button" class="btn btn-primary" id="registerUser">Add<\/button>';i='<button type="button" class="btn btn-default" data-dismiss="modal">Close<\/button><button type="button" class="btn btn-primary" id="updateUser">Update<\/button>';$("#registerNewUser").click(function(){$.ajax({url:n+"/SystemUser/Register",type:"GET",dataType:"html",success:function(n){$("#userModel").modal("show");$("#userModel > .modal-dialog > .modal-content > .modal-body").html("");$("#userModel > .modal-dialog > .modal-content > .modal-body").append(n);$("#userModel > .modal-dialog > .modal-content > .modal-header > .modal-title").html("User Registration");$("#userModel > .modal-dialog > .modal-content > .modal-footer").html("");$("#userModel > .modal-dialog > .modal-content > .modal-footer").append(t);$("#RegistrationView").removeData("validator");$("#RegistrationView").removeData("unobtrusiveValidation");$.validator.unobtrusive.parse("#RegistrationView")},error:function(){console.log("AJAX ERROR")}})});$("#btnUpdateUserDetails").on("click",function(){var n=$("#UpdateUserDetails").find("input[name='UserId']"),t=n.attr("value");$("#IncludedRoles option").prop("selected","selected");$("#SystemRoles option").prop("selected","selected");$("#UpdateUserDetails").submit()});$(function(){$(".modal").on("hidden.bs.modal",function(){$(this).removeData("bs.modal")})});$("#RegistrationView :input").on("focusout",function(){$(this).text()!==null&&$(this).valid()});$("#RegistrationView :input").on("focusin",function(){$(this).next().text("").removeClass("text-success").addClass("text-danger")});$("#RegistrationModel_UserName").on("focusout",function(){$(this).val()!==""&&validateUsername($(this).val())});$("#RegistrationModel_Email").on("focusout",function(){($("#ValidationErrorEmail").text()===""||$("#ValidationErrorEmail").hasClass("text-success"))&&o($(this).val())})});